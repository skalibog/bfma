# Binance Futures Market Analyzer (BFMA)

Профессиональный инструмент анализа рынка фьючерсов Binance для алгоритмической торговли. Собирает данные из нескольких источников, проводит комплексный анализ и генерирует точные торговые сигналы.

## Архитектура

```
bfma/
├── cmd/                     # Точки входа в приложение
│   └── bfma/                # Основной бинарный файл
│       └── main.go
├── internal/                # Внутренний код приложения
│   ├── config/              # Конфигурация
│   ├── exchange/            # Взаимодействие с биржей
│   ├── storage/             # Хранение данных
│   ├── analysis/            # Модули анализа
│   │   ├── technical/       # Технические индикаторы
│   │   ├── orderbook/       # Анализ стакана
│   │   ├── funding/         # Анализ ставок финансирования
│   │   ├── oianalysis/      # Анализ открытого интереса
│   │   ├── volumedelta/     # Анализ дельты объемов
│   │   └── aggregator/      # Агрегатор сигналов
│   └── ui/                  # Пользовательский интерфейс
├── pkg/                     # Публичные пакеты
│   ├── indicator/           # Реализация индикаторов
│   ├── models/              # Структуры данных
│   └── utils/               # Утилиты
└── docs/                    # Документация
```

## Технологический стек

- **Язык**: Go 1.20+
- **API клиент**: github.com/adshao/go-binance/v2
- **Технический анализ**: github.com/markcheno/go-talib
- **Хранение данных**: InfluxDB (временные ряды)
- **UI в терминале**: github.com/mum4k/termdash
- **Логирование**: github.com/uber-go/zap
- **Конфигурация**: github.com/spf13/viper

## Функциональные компоненты

### 1. Сбор данных

- WebSocket-подключение для стакана и свечей
- Периодический запрос ставок финансирования
- Отслеживание открытого интереса
- Получение данных тиковых объемов

### 2. Анализаторы и их веса

| Категория | Компоненты | Вес |
|-----------|------------|-----|
| Технический анализ | RSI, MACD, Bollinger Bands, ATR, Ichimoku | 30% |
| Анализ стакана | Дисбалансы, уровни сопротивления/поддержки, глубина | 25% |
| Финансирование | Ставки, экстремумы, смена направления | 15% |
| Открытый интерес | Дивергенции OI/Цена, резкие изменения | 15% |
| Дельта объемов | Кумулятивная дельта, аномальные объемы | 15% |

### 3. Агрегация сигналов

1. Каждый анализатор генерирует сигнал от -100 до +100
2. Сигналы взвешиваются согласно весам
3. Итоговый сигнал рассчитывается как взвешенная сумма
4. Сила сигнала определяет размер позиции

### 4. Критерии входа в сделку

- **Strong Buy**: Агрегированный сигнал > 70
- **Buy**: Агрегированный сигнал 50-70
- **Neutral**: Агрегированный сигнал -50 до 50
- **Sell**: Агрегированный сигнал -70 до -50
- **Strong Sell**: Агрегированный сигнал < -70

## Хранение данных

Данные хранятся на трех уровнях:
1. **В памяти**: Оперативные данные для быстрого анализа
2. **InfluxDB**: Исторические данные для долгосрочного анализа
3. **Файлы**: Журналы сигналов и транзакций

## Пользовательский интерфейс

Интерактивный TUI (Terminal User Interface) с разделами:
- Текущие сигналы и рекомендации
- Графики ключевых индикаторов
- Визуализация стакана
- Журнал активности
- Статистика по стратегии

## Установка и запуск

```bash
# Установка
git clone https://github.com/skalibog/bfma.git
cd bfma
go build -o bfma ./cmd/bfma

# Запуск
./bfma --config config.yaml
```

## Пример настройки (config.yaml)

```yaml
binance:
  api_key: "ваш_ключ_api"
  api_secret: "ваш_секрет_api"
  testnet: false

trading:
  symbols: ["BTCUSDT", "ETHUSDT", "SOLUSDT"]
  interval: "1m"
  risk_per_trade: 0.01  # 1% от счета на сделку

analysis:
  technical:
    weight: 0.30
    rsi_period: 14
    bb_period: 20
    macd_fast: 12
    macd_slow: 26
    macd_signal: 9

  orderbook:
    weight: 0.25
    depth: 20
    imbalance_threshold: 1.5

  funding:
    weight: 0.15
    periods: 3
    extreme_threshold: 0.1%

  open_interest:
    weight: 0.15
    lookback: 24
    change_threshold: 5%

  volume_delta:
    weight: 0.15
    lookback: 12
    significance_threshold: 1.5

signal:
  threshold_strong_buy: 70
  threshold_buy: 50
  threshold_sell: -50
  threshold_strong_sell: -70
```

## Алгоритм работы

1. Инициализация и загрузка конфигурации
2. Подключение к Binance API
3. Синхронизация исторических данных
4. Запуск потоков сбора данных в реальном времени
5. Периодический анализ на основе всех компонентов
6. Агрегация сигналов с учетом весов
7. Вывод рекомендаций на экран
8. Логирование результатов